<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Click Track Tempo Setter</title>
</head>
<body>
  <h1>Set Your Click Track Tempo</h1>
  <button id="tempoButton">Tap Tempo</button>
  <button id="pauseButton" disabled>Pause</button>
  <p id="status">Click the button 4 times to set the tempo.</p>
  
  <audio id="clickSound" src="click-sound.wav"></audio> <!-- Use the .wav file for the click sound -->

  <script>
    let clickTimes = [];
    let intervalId;
    let isPlaying = false;

    const tempoButton = document.getElementById('tempoButton');
    const pauseButton = document.getElementById('pauseButton');
    const statusText = document.getElementById('status');
    const clickSound = document.getElementById('clickSound');

    tempoButton.addEventListener('click', () => {
      const now = Date.now();

      // Store the time of each click (up to 4 times)
      clickTimes.push(now);
      if (clickTimes.length === 4) {
        // Calculate intervals between clicks
        const intervals = [
          clickTimes[1] - clickTimes[0],
          clickTimes[2] - clickTimes[1],
          clickTimes[3] - clickTimes[2]
        ];

        // Find the average interval
        const avgInterval = intervals.reduce((sum, interval) => sum + interval, 0) / intervals.length;

        // Set up click track based on the average interval
        if (intervalId) clearInterval(intervalId); // Stop previous click track if running
        intervalId = setInterval(() => {
          clickSound.currentTime = 0;
          clickSound.play();
        }, avgInterval);

        isPlaying = true;
        pauseButton.disabled = false;
        statusText.textContent = `Click track set to ${Math.round(60000 / avgInterval)} BPM`;
        clickTimes = []; // Reset for next time
      }
    });

    pauseButton.addEventListener('click', () => {
      if (isPlaying) {
        clearInterval(intervalId);  // Stop the click track
        pauseButton.textContent = "Resume";
        isPlaying = false;
      } else {
        // Resume with the previous interval
        intervalId = setInterval(() => {
          clickSound.currentTime = 0;
          clickSound.play();
        }, 60000 / parseInt(statusText.textContent.match(/\d+/)[0])); // Use the last BPM from the status text
        pauseButton.textContent = "Pause";
        isPlaying = true;
      }
    });
  </script>
</body>
</html>
